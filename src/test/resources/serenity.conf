# Configuración principal de Serenity BDD
serenity {
  project.name = "Mi Proyecto Serenityyyyyyyyyyyyyyyyyyyyyyyyyyyyyy"
  report.title = "Reporte de Pruebas Automatizadas"
  console.colors = true
  take.screenshots = AFTER_EACH_STEP
  test.root = "starter.acceptancetests"
  logging = VERBOSE
}

# El driver por defecto será chrome
webdriver.driver = ${driver}

environments {
  default {
    webdriver.base.url = "https://duckduckgo.com"
  }
  chrome {
    webdriver {
      driver = chrome
      webdriver.chrome.driver = "automatic"  # WebDriverManager lo manejará
      capabilities {
        browserName = "chrome"
        acceptInsecureCerts = true
        "goog:chromeOptions" {
          args = [
            "--incognito",                   # Modo incógnito
            #"--headless=new",                # Modo headless (nueva versión)
            "--remote-allow-origins=*",
            "--start-maximized", # funciona, pero causa conflicto con headless, mejor usar window-size
            "--disable-infobars",
            "--disable-notifications",
            "--no-sandbox", # sirve para evitar problemas en entornos Linux
            "--disable-dev-shm-usage",
            "--disable-gpu",
            #"--window-size=1920,1080",        # Tamaño de ventana para headless
            "--user-agent=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36" # User-Agent personalizado, sirve para evitar bloqueos en ejecuciones de modo headless
          ]
        }
      }
    }
  }
  edge {
    webdriver {
      driver = edge
      webdriver.edge.driver = "automatic" # WebDriverManager lo manejará
      capabilities {
        browserName = "MicrosoftEdge"
        acceptInsecureCerts = true
        "ms:edgeOptions" {
          args = [
          "--inprivate",                    # Modo InPrivate (incógnito)
           "--headless=new",                # Modo headless (descomentar para activar)
            #"--start-maximized", # funciona, pero causa conflicto con headless, mejor usar window-size
            "--disable-infobars",
            "--disable-notifications",
            "--remote-allow-origins=*"
            "--window-size=1920,1080",        # Tamaño fijo para headless
            "--disable-dev-shm-usage",
            "--disable-gpu",
            "--disable-extensions",
            "--disable-features=TranslateUI",
            "--user-agent=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36"
          ]
        }
      }
    }
  }
  firefox {
    webdriver {
      driver = firefox
      webdriver.gecko.driver = "automatic"  # WebDriverManager lo manejará
      capabilities {
        browserName = "firefox"
        acceptInsecureCerts = true
        "moz:firefoxOptions" {
          args = [
            "-private",
            "-headless",
            "--window-size=1920,1080"
          ]
        }
      }
    }
  }
}

timeouts {
  implicitly.wait = 10000
  wait.for.timeout = 20000
}
